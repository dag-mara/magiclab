(function($,window,undefined){'use strict';var originalTopBarOffset,originalTopBarHeight;var topBar=$('.top-bar');var topBarParent=topBar.parent();topBarParent.addClass('hw-acc');originalTopBarHeight=topBar.height();topBar.hide();var is_landscape=function(){return window.innerWidth>window.innerHeight};var updateTopBarVars=function(prev_el){originalTopBarOffset=prev_el.offset().top+prev_el.height()-2;if(is_landscape()){originalTopBarOffset=originalTopBarOffset-originalTopBarHeight}};var doc=$(document);var win=$(window);var body=$('body');var updateTopBarPosition=function(){if(doc.scrollTop()>originalTopBarOffset){topBarParent.addClass('sticky-top');body.addClass('has-sticky-top')}else{topBarParent.removeClass('sticky-top');body.removeClass('has-sticky-top')}};var topBarInit=function(prev_el){updateTopBarVars(prev_el);updateTopBarPosition();topBar.fadeIn(300)};var featProjects=$('.featured.projects');var updateBodyClass=function(){if(doc.scrollTop()+win.height()>featProjects.offset().top+100){body.addClass('scrolled')}else{body.removeClass('scrolled')}};MagicLab.videoLightBox=function(){var orb_controls=$('.orbit-slide-number,.orbit-prev,.orbit-next,.orbit-timer,.orbit-bullets-container');var b=$('body');var h;var overlay=$('<div/>',{'class':'video-overlay'}).click(function(e){$('.orbit-timer','.featured-slider').click();closeOverlay()});var openOverlay=function(){orb_controls.fadeOut(800);b.addClass('overlay-active');$('<span/>',{'class':'close-video-overlay'}).click(function(e){e.preventDefault();closeOverlay()}).appendTo(overlay);overlay.appendTo(b).fadeIn()};var closeOverlay=function(){orb_controls.fadeIn(800);if(h){h.fadeOut()}
overlay.fadeOut(800,function(){overlay.html('').remove();b.removeClass('overlay-active')})};var appendVideoIframe=function(el){var videoID=el.data('videoid');$('<iframe/>',{'class':'inserted-video','src':'//player.vimeo.com/video/'+videoID+'?byline=0&portrait=0&title=0&badge=0&autoplay=1&api=1','css':{width:'100%',height:'100%'},'frameborder':0,'allowfullscreen':'true',}).appendTo(overlay)};$('.play_button,.trailer-link-project-lightbox,.vfx-link-project-lightbox').click(function(e){e.preventDefault();if(b.is('.overlay-active'))
return!1;var t=$(this);var p=t.parent();var is_trailer=t.is('.trailer-link-project-lightbox,.vfx-link-project-lightbox');if(!is_trailer){$('body,html').stop(!0,!0).animate({'scrollTop':0},250)}
openOverlay();appendVideoIframe(t);if(!is_trailer){h=$('.video-slide-title',p).clone().appendTo(overlay).fadeIn(800)}
$('.orbit-timer.paused','.featured-slider').click()})};MagicLab.finishedProjects={'init':function(){this.showAllButton=$('#finished-projects-show-all');this.view=$('<div/>',{'id':'info-wrapper','class':'info-wrapper'}).appendTo('.top-bar','#access');this.infoboxes=$('.finished-project-info').clone();this.infoboxes.appendTo(this.view).show();var self=this;this.showAllButton.click(function(e){e.preventDefault();var t=$(this);if(MagicLabL10n.all===t.text()){t.text(MagicLabL10n.showLess)}else{t.text(MagicLabL10n.all)}
$('body').toggleClass('finished-projects-collapsed')});$('.finished-project a','#finished-projects').on('click',function(e){e.preventDefault();var t=$(this);var p=t.parent();if(p.is('.active')){self.view.addClass('anim_slide');self.closeView();return}
var active=$('.finished-project.active,.finished-project-info.active');var target_id=t.next('.finished-project-info').data('info-id');if(active.length){self.view.removeClass('anim_slide').addClass('anim_fade');self.closeView()}else{self.view.removeClass('anim_fade').addClass(' anim_slide')}
p.addClass('active');$('[data-info-id='+target_id+']',self.view).addClass('active');$('body').addClass('finished-project-opened')});this.view.on('click','.info-close',function(){self.view.addClass('anim_slide');self.closeView()});$(document).click(function(event){if(!$(event.target).closest('.finished-project,#info-wrapper,.video-overlay').length&&!$(event.target).is('.orbit-timer')){if($('.active',self.view).length){self.view.addClass('anim_slide');self.closeView()}}})},'resetView':function(){},'closeView':function(){$('.finished-project.active,.finished-project-info.active').removeClass('active');$('body').removeClass('finished-project-opened')},'isSmallView':function(){return $(document).width()<641}};MagicLab.sliderParallax=function(){var fps=80;var diff=2;var container=$('#featured');if(!container.length){return}
var elements=container.add('.orbit-next,.orbit-prev,.orbit-bullets');elements.css({'will-change':'transform','transform':'translateY(0)',})
var updateElementsPosition=function(){var newtop=window.scrollY/diff;newtop=newtop>=0?newtop:0;elements.css({'transform':'translateY('+newtop+'px)'})}
$(document).ready(function(){updateElementsPosition()});$(window).on('scroll',_.throttle(function(){updateElementsPosition()},1000/fps))};$(document).ready(function(){MagicLab.finishedProjects.init();MagicLab.videoLightBox();if(!MagicLab.utils.isMobile){MagicLab.sliderParallax()}
updateBodyClass();var featured_slider=$('#featured');if(featured_slider.length){body.addClass('js-orbit-ready');topBarInit(featured_slider);updateBodyClass();var feat_timer=$('.orbit-timer');if(feat_timer.is('.paused')){feat_timer.click()}
$('.toggle-topbar a','#access').click(function(){featured_slider.toggle()});if($('body').width()>700){$('<a/>',{'href':'#','text':'Scroll Down','class':'scroll-down-arr'}).appendTo($('.top-bar')).click(function(e){e.preventDefault();$('body,html').stop(!0,!0).animate({'scrollTop':featured_slider.offset().top+featured_slider.outerHeight()-70},750)})}}});var featured_slider=$("#featured");$(window).on('scroll',_.throttle(function(){updateTopBarPosition();updateBodyClass()},1000/80));$(window).on('resize',_.throttle(function(){updateTopBarVars(featured_slider);updateTopBarPosition()},1000/60))})(jQuery,this)